---
title: "Snowshoe Report - Emily Pelstring"
author: "Emily Pelstring"
date: "11/6/2021"
output: html_document
---

```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(here)
library(janitor)
library(ggthemes)
library(lubridate)
library(ggbeeswarm)
library(kableExtra)
library(effsize)
```

## Introduction

## Data and Analyses

## Juvenile Hare Initial Investigation

```{r}
## Reading in the Data 
bonanza_hares <- read.csv(here("data", "bonanza_hares.csv"))

## Creating a column to include years 
bonanza_hares <- bonanza_hares %>%
  mutate(date_new = mdy(date)) %>%
  mutate(year_new = year(date_new))

## total hare trap counts 
total_hare_trapcounts <- bonanza_hares %>%
  group_by(year_new) %>%
  filter(age == "j") %>%
  count()

## Mean and Median of Count
mean_count <- round(mean(total_hare_trapcounts$n), 1)
median_count <- round(median(total_hare_trapcounts$n), 1)

## visualization of total hare trap counts 
total_hare_trapcounts %>%
  ggplot(aes(x = year_new,
             y = n)) +
  geom_col() + 
  theme_economist() +
  theme(text = element_text(size = 11, family = "Times New Roman")) +
  labs(x = "Year",
       y = "Number of Hares",
       title = "Total Juvenile Hare Trap Counts by Year (PELSTRING)")

```

**Figure (FILL FIGURE NUMBER).** Total number of juvenile hares observed from the years 1999 - 2012. Each bar signifies total number (y-axis) of juvenile hares observed by year (x-axis). Data: (ADD DATA CITATION).

### Major Findings 

Among reporting years, the highest number of juvenille hare observations was in 1996 with 126 observations, while the lowest took place in 2010 with 2 observations. The mean number of juvenille hare observations per year is `r mean_count` hares, and the median number of juvenille hare observations through all years is `r median_count` hares. According to the column graph, it appears as though there was a marked decline in juvenile hare populations from when observations first began in 1996. This decline in juvenile hare observations may signal that there is a decline in reproduction rates of adult hares; however, before these assumptions can be made, sampling methodology must be examined. Dividing each observation by number of days spent recording, as well as number of traps set out, would help to normalize the data between years. 

## Visualize Juvenile Hare Weights by Site and Sex

```{r}
## Filtering for only juvenile hares 
juvenile_hares <- bonanza_hares %>%
  filter(age == "j") %>% 
  mutate(grid = case_when(
    grid %in% c("bonrip") ~ "Riparian",
    grid %in% c("bonbs") ~ "Black Spruce",
    grid %in% c("bonmat") ~ "Mature Mixed"))

## Plotting for Juvenile hare weights by site and sex. 
ggplot(data = juvenile_hares, aes(x = sex, y = weight)) + #selecting data, setting x value as site and y value as weight 
  geom_beeswarm(aes(color = sex)) + #type of graph, splitting color by sex
  scale_color_manual(values = c("coral","blue3","coral"), #adding specific colors by vector 
                     name = "Sex", labels = c("female", "male", "NA")) + #changing label text
  theme_economist() + #adding theme
  theme(text = element_text(size = 10, family = "Times New Roman")) + #changing graph text size and font
  labs(x = "", #labeling axes
       y = "Weight (grams)",#labeling axes
       title = "Weight of Juvenile Hares by Sex and Site (PELSTRING)") + #adding title
  facet_wrap(~grid) #faceting by site 
```
**Figure (FILL FIGURE NUMBER).** Distribution of weight of juvenile hares at three sampling sites, separated by sex via coloring. Sex is displayed on the x-axis while weight is displayed on the y-axis, and the data is faceted by site. The amount of observations between sites varied, with bonbs (Bonanza Back Spruce) having the lowest number of observations available and bonrip (Bonanza Riparian) with the highest number of samples available.

### Main Takeaways 

According to the graph, it appears that there are no significant differences between male and female juvenile hare weights in any of the three observation sites. It appears as though the weight of male juvenile hares is slightly higher than the weight of female juvenile hares. There is also no significant difference in distribution of weights between the three sites. There are fewer observations available at the bonbs site compared to the bonmat and bonrip site, which may impact the ability to draw conclusions regarding the lack of significant difference in weights between that and the two other sites. 

## Juvenile Weight Comparison (male & female snowshoe hares)

**Table 1.** Descriptive statistics (mean, standard deviation, sample size) for male and female juvenile hares. Data: (ADD DATA CITATION)
```{r}
juvenile_table <- juvenile_hares %>%
  group_by(sex) %>%
  mutate(sex = case_when(
    sex %in% c("f") ~ "Female",
    sex %in% c("m") ~ "Male",
    sex %in% c("NA") ~ "NA")) %>%
  summarize(
    mean_juvenile_weight = round(mean(weight, na.rm = TRUE), 1),
    sd_juvenile_weight= round(sd(weight, na.rm = TRUE), 1),
    n = n())

juvenile_table %>%
  kable(col.names = c("Sex", "Mean Juvenile Weight (g)", "Standard Deviation", "Sample Size")) %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE)
   
   
```
```{r include = FALSE}
## Exploratory Graphs 

ggplot(data = juvenile_hares,
       aes(x = weight)) +
  geom_histogram(bins = 10) +
  facet_wrap(~sex)
  
ggplot(data = juvenile_hares,
       aes(sample = weight)) +
  geom_qq() + 
  facet_wrap(~sex)
```



## Means Comparisons 

```{r}
# Finding difference in means 

difference_in_means <- juvenile_table$mean_juvenile_weight[2] - juvenile_table$mean_juvenile_weight[1]

# storing vectors for male and female weights for use in Cohen and T-test

female_weight <- juvenile_hares %>% #vector for female weights
  filter(sex == "f") %>% #filtering for only female
  drop_na(weight) %>% #removing na values
  pull(weight) #vector of just the weight column

male_weight <- juvenile_hares %>% #vector for male weights
  filter(sex == "m") %>% #filtering for only male
  drop_na(weight) %>% #removing na values
  pull(weight) #vector of just the weight column

weight_t <- t.test(x = male_weight, y = female_weight) # t-test

weight_t #viewing t-test

weight_cohen <- cohen.d(female_weight, male_weight) #effect size 

weight_cohen #viewing cohen 

```

Mean weight for male juvenile hares (`r round(weight_t$estimate[1],2)` g) is greater than that for female juvenile hares (`r round(weight_t$estimate[2],2)` g); The difference in the means between them is `r difference_in_means` g. The effect size is small (Cohen's *d* = `r round(weight_cohen$estimate,2)`) and the difference significant (two-sample t-test, t = `r round(weight_t$statistic,2)`, p = 0.007)

## Juvenile Hare Weight versus Hind Foot Length 

```{r}
ggplot(data = juvenile_hares,
       aes(x = weight, y = hindft)) +
  geom_jitter() +
  theme_economist() +
  theme(text = element_text(size = 11, family = "Times New Roman")) +
  labs(x = "Weight (g)",
       y = "Hind Foot Length (mm)",
       title = "Weight Versus Hind Foot Length (PELSTRING)")
```
**Figure (FILL FIGURE NUMBER).** Distribution of weight (in grams) of juvenile hares versus hind foot length (in millimeters). Juvenile hare weight is displayed on the x-axis, while hind foot length is on the y-axis. Each hare observation is represented by a dot on the graph. 
